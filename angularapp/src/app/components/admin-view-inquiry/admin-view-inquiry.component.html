<h1>Manage Property Inquiries</h1>

<div class="container">
  <div class="form-group">
    <!-- <label for="searchby">Search by:</label> -->
    <input type="text" id="searchText" [(ngModel)]="searchText" (input)="applyFilters()"
      placeholder="Search Property">
  </div>
  <!-- <input type="text" [(ngModel)]="searchText" placeholder="Search inquiry"> -->

  <select [(ngModel)]="selectedStatus" (change)="applyFilters()">
    <option value="">Filter By Status</option>
    <option value="Pending">Pending</option>
    <option value="Resolved">Resolved</option>
  </select>

  <!-- <select [(ngModel)]="selectedPriority" (change)="filterbypriority()">
    <option value="">Filter By Priority</option>
    <option value="High">High</option>
    <option value="Medium">Medium</option>
    <option value="Low">Low</option>
  </select> -->
</div>

<div class="container-table">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>User</th>
        <th>Property</th>
        <th>Message</th>
        <th>Status</th>
        <!-- <th>Priority</th> -->
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let inquiry of inquiries">
        <td>{{ inquiry.inquiryId }}</td>
        <td>{{ inquiry.user.username }}</td>
        <td>{{ inquiry.property.title }}</td>
        <td>{{ inquiry.message }}</td>
        <td>

          <span [ngStyle]="{'color': inquiry.status === 'Pending' ? 'red' : 'green'}">
            {{ inquiry.status }}
          </span>

          <!-- <select [(ngModel)]="inquiry.status">
                <option value="Pending">Pending</option>
                <option value="Resolved">Resolved</option>
              </select> -->
        </td>
        <td>

          <button *ngIf="inquiry.status === 'Pending'" (click)="addResponse(inquiry)">Add
            Response</button>
          <button *ngIf="inquiry.status === 'Resolved'" (click)="editResponse(inquiry)">Edit
            Response</button>
          <button (click)="deleteInquiry(inquiry.inquiryId)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="showaddResponseModal" class="popup-overlay">
  <div class="popup-box">
    <h3>{{ isEditMode ? 'Edit Response' : 'Add Response' }}</h3>
    <textarea [(ngModel)]="responseText" placeholder="Enter your response" cols="48" rows="10"></textarea>
    <br><br>
    <div class="popup-buttons">
      <button (click)="submitResponse()">Submit</button>
      <button (click)="cancelResponse()">Cancel</button>
    </div>
  </div>
</div>

<div *ngIf="showDeleteModal" class="popup-overlay">
  <div class="popup-box">
    <p>Are you sure you want to delete this inquiry?</p>
    <div class="popup-buttons">
      <button (click)="confirmDelete()">Yes, Delete</button>
      <button (click)="cancelDelete()">Cancel</button>
    </div>
  </div>
</div>